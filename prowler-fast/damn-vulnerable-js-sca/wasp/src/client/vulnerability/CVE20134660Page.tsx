import React, { useState } from "react";
import { PageLayout } from "../PageLayout";
import { DisplaySmall } from "baseui/typography";
import { Button } from "baseui/button";
import { Textarea } from "baseui/textarea";
import exploitCVE20134660 from '@wasp/actions/exploitCVE20134660'

const CVE20134660Page = () => {
  const [query, setQuery] = useState<string>('');
  const [info, setInfo] = useState<string|null>(null);

  return (
    <PageLayout>
      <DisplaySmall>Deserialization Code Execution in js-yaml</DisplaySmall>
      <p>CVE-2013-4660</p>
      <p>Fixed in 2.0.5</p>
      <a href={"https://nealpoole.com/blog/2013/06/code-execution-via-yaml-in-js-yaml-nodejs-module/"}>POC</a>

      <Textarea onChange={(e) => setQuery(e.target.value)} />
      <Button onClick={async () => {
        const result = await exploitCVE20134660({ yaml: query });
        setInfo(JSON.stringify(result.result));
      }}>
        Exploit!
      </Button>
      {info && (
        <>
          <DisplaySmall>Here is your parsed YAML!</DisplaySmall>
          <p>{info}</p>
        </>
      )}
    </PageLayout>
  );
};
export default CVE20134660Page;
