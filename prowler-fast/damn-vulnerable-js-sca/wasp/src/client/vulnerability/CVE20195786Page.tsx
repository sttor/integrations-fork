import React, { useState } from "react";
import { PageLayout } from "../PageLayout";
import { DisplaySmall } from "baseui/typography";
import { Button } from "baseui/button";
import { Input } from "baseui/input";
import exploitCVE20195786 from '@wasp/actions/exploitCVE20195786'

const CVE20195786Page = () => {
  const [query, setQuery] = useState<string>('');
  const [info, setInfo] = useState<string|null>(null);

  return (
    <PageLayout>
      <DisplaySmall>RCE in puppeteer</DisplaySmall>
      <p>CVE-2019-5786</p>
      <p>Fixed in 1.13.0</p>
      <p>Note: The POC needs to be tested. In preliminary tests, POC did not result in exploitation.</p>
      <a href={"https://github.com/exodusintel/CVE-2019-5786"}>POC</a>

      <Input placeholder={"url"} onChange={(e) => setQuery(e.target.value)} />
      <Button onClick={async () => {
        const result = await exploitCVE20195786({ url: query });
        setInfo(result.title);
      }}>
        Exploit!
      </Button>
      {info && (
        <>
          <DisplaySmall>Website title</DisplaySmall>
          <p>{info}</p>
        </>
      )}
    </PageLayout>
  );
};
export default CVE20195786Page;
