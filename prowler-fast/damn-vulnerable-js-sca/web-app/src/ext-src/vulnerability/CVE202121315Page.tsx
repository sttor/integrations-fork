import React, { useState } from "react";
import { PageLayout } from "../PageLayout";
import { DisplaySmall } from "baseui/typography";
import { Button } from "baseui/button";
import { Input } from "baseui/input";
import exploitCVE202121315 from '../../actions/exploitCVE202121315'

const CVE202121315Page = () => {
  const [query, setQuery] = useState<string>('');
  const [info, setInfo] = useState<string|null>(null);

  return (
    <PageLayout>
      <DisplaySmall>Command Injection in systeminformation</DisplaySmall>
      <p>CVE-2021-21315</p>
      <p>Fixed in 5.3.1</p>
      <a href={"https://github.com/ForbiddenProgrammer/CVE-2021-21315-PoC"}>POC</a>

      <Input onChange={(e) => setQuery(e.target.value)} />
      <Button onClick={async () => {
        const result = await exploitCVE202121315({ query: [query] });
        setInfo(JSON.stringify(result.info));
      }}>
        Exploit!
      </Button>
      {info && (
        <>
          <DisplaySmall>System Information</DisplaySmall>
          <p>{info}</p>
        </>
      )}
    </PageLayout>
  );
};
export default CVE202121315Page;
