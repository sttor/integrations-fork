# Objectives

Perform an IDOR attack to change the passwords of users we don't have access to with the help of BurpSuite.

# Solutions

In any application, whenever a user generates, sends, or receives a request from a server, there are some HTTP parameters such as 'id', 'uid', 'pid', etc that have some unique values which the user has been assigned. An attacker might be able to tamper with these values and this tampering may lead to an Insecure Direct Object Reference (IDOR) vulnerability.

Navigate to the profile of the user you have currently logged in as. There you can change the current password to a new one. Set the new password as:

Password - jameshill@123

After changing the password, inspect the page to view the request payload that was sent in the request. You will see something like this:

![](https://user-images.githubusercontent.com/65826354/179528125-125821b5-4bd7-470c-985f-e676d0ebfcbb.png)

Now go to Burp's embedded browser. Again, go to the user profile there and change the password again, this time set the password as:

Password - jameshill

Make sure that before clicking on 'Change password', you have turned the intercept ON from BurpSuite, as we need to intercept the request we are sending. We will again change the parameters manually to get the desired response in the following steps. Forward the request in BurpSuite and send the request to repeater.

Again, we are sending the request to repeater so that we can manually change parameters, and request methods, and see the response as burp repeater is a tool that is designed to allow the user or attacker to change or resend a particular HTTP request and analyze the response generated by it.

The main step in an IDOR attack is to change the parameters like 'id' in our request. And that is exactly what we will do here. As we can see in the image above, the initial parameters while changing the password were:

```
{id:"8", newPassword:"jameshill", confirmNewPassword:"jameshill"}
```

Now we will replace the value of the 'id' parameter with 0.

```
{id:"0", newPassword:"jameshill", confirmNewPassword:"jameshill"}
```

After changing the parameter, send the request through the repeater to generate the response. See, 0, as you would imagine, is not a valid id, hence the response will generate an error, which is expected. This is to show you that whenever we will pass an invalid parameter, an error will be generated which will look like this:

![](https://user-images.githubusercontent.com/65826354/179528143-bce67df2-30f0-4345-8603-89c7c88f0fc5.png)

Let us try replacing the value of id with 100. It again shows the same error, implying that id=100 is again not a valid input.

Now try to replace the value of id with 1. After sending the request, you will see that this time, as we have entered a valid id, we are successful in changing the password and the response looks like this:

![](https://user-images.githubusercontent.com/65826354/179528151-fa7a1dce-41b3-43b4-b7bc-c67699a8b6f9.png)

Hence we can see that we have successfully changed the password for the user with id=1, which is a different user than the one we are currently logged in as. Therefore we have completed our IDOR attack and managed to change the password of a completely different user.

Now, just to confirm that our attack was successful, we will try to log in as the user whose password we just changed. For that, we will require the email id of that user. That is now a very easy task for us as we had already performed an SQLi attack. Here we will repeat some of the steps of the SQLi attack.

In the Burp's embedded user, we will go to the Users tab, and again search for a random character, let it be u this time. This is done just so that we can intercept the request and send it to the repeater to change the parameters manually, as you are already familiar with. Now again, we will alter the 'value' and 'authlevel' parameters and replace their values with the following:

```
"value":"hello' or '1'='1"
"authlevel":"' or '1'='1"
```

When you send this request, you will again get all the data of all the users in the response. From that data, find out the user with id=1 and grab its email. Here's a picture of the required response for you:

![](https://user-images.githubusercontent.com/65826354/179528160-487bbc8c-8e90-4ce7-af66-0012b42ef2b7.png)

Now go back to the normal browser and log out of the current account. Then use the email id that you just grabbed and the password that you changed to log into the account. You will see that you have successfully managed to log into an account that you didn't have access to.
